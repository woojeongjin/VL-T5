description: VLT5 pretrain

target:
  service: amlk8s
  # run "amlt target list amlk8s" to list the names of available AMLK8s targets
  name: itp-scus-v100
  vc: AlexTScience

storage:
  data:
    storage_account_name: tsinterns
    container_name: t-wjin
    mount_dir: /mnt/root

environment:
  image: pytorch/pytorch:1.6.0-cuda10.1-cudnn7-devel
  # image: mcr.microsoft.com/azureml/base-gpu:openmpi3.1.2-cuda10.0-cudnn7-ubuntu16.04
  registry: docker.io # any public registry can be specified here
  setup:
    # - sudo pip install -U pip setuptools
    # - sudo apt-get install git
    # - pip install --upgrade pip
    - pip install git+https://github.com/j-min/language-evaluation.git
    - pip install -r requirements.txt

code:
  # local directory of the code. this will be uploaded to the server.
  # $CONFIG_DIR is expanded to the directory of this config file
  # local_dir: $CONFIG_DIR/src
  local_dir: $CONFIG_DIR

# data:
#   data upload is not required for this example

# list of jobs to run, we run 2 jobs in this example
jobs:
- name: prefix
  sku: G4
  command:
  - bash scripts/pretrain_VLT5_prefix.sh 4
# - name: low_lr2
#   sku: G1
#   command:
#   - python main.py --lr 0.1
